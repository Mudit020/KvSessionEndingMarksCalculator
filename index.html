<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Session Ending Marks Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .main-content {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 900px;
            width: 100%;
            padding: 40px;
            margin-top: 20px;
            margin-bottom: 20px;
            position: relative;
        }

        /* --- BACK BUTTON STYLE --- */
        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: transparent;
            border: none;
            font-size: 1.1em;
            color: #666;
            cursor: pointer;
            font-weight: bold;
            display: none;
            transition: color 0.3s ease;
            z-index: 100;
            padding: 5px; /* Added padding for better touch target */
        }
        .back-btn:hover { color: #667eea; transform: translateX(-3px); }

        h1 { text-align: center; color: #333; margin-bottom: 10px; font-size: 2.5em; line-height: 1.2; }
        .subtitle { text-align: center; color: #666; margin-bottom: 30px; font-size: 1.1em; }

        /* --- STREAM INDICATOR --- */
        .active-stream-title {
            text-align: center;
            color: #667eea;
            font-size: 1.3em;
            font-weight: 700;
            margin-bottom: 25px;
            padding: 10px;
            background: #f0f4ff;
            border-radius: 8px;
            display: none;
            border: 1px solid #dbeafe;
        }

        .selection-container { display: none; gap: 20px; justify-content: center; margin-bottom: 30px; flex-wrap: wrap; }
        .visible { display: flex !important; animation: fadeIn 0.5s ease; }

        .stream-btn {
            padding: 15px 30px; font-size: 1.1em; border: 2px solid #667eea;
            background: white; color: #667eea; border-radius: 8px; cursor: pointer;
            transition: all 0.3s ease; font-weight: 600; min-width: 160px;
        }
        .stream-btn:hover { background: #667eea; color: white; transform: translateY(-3px); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3); }

        .subjects-container { display: none; }
        .subjects-container.active { display: block; animation: slideUp 0.5s ease; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .subject-section {
            margin-bottom: 40px; padding: 25px; background: #f8f9fa;
            border-radius: 10px; border-left: 5px solid #667eea;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .subject-title {
            font-size: 1.4em; color: #333; margin-bottom: 20px; font-weight: 700;
            text-transform: uppercase; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;
        }

        .subject-badge { font-size: 0.6em; background: #e9ecef; padding: 4px 8px; border-radius: 4px; color: #666; font-weight: normal; white-space: nowrap; }

        .input-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px; }
        .input-row.full { grid-template-columns: 1fr; }
        .form-group { display: flex; flex-direction: column; }
        
        label { margin-bottom: 8px; color: #555; font-weight: 600; font-size: 0.95em; }
        
        input[type="number"] {
            padding: 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 1em; transition: all 0.3s ease; width: 100%;
        }
        input[type="number"]:focus { outline: none; border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); }
        
        .input-error { border-color: #dc3545 !important; background-color: #fff8f8; }
        .input-hint { font-size: 0.85em; color: #999; margin-top: 2px; font-weight: normal; }

        .button-group { display: none; gap: 15px; justify-content: center; margin-top: 40px; }
        button { padding: 14px 40px; font-size: 1.1em; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; }
        
        .calculate-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; flex: 1; max-width: 250px; box-shadow: 0 4px 15px rgba(118, 75, 162, 0.3); }
        .calculate-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(118, 75, 162, 0.4); }
        
        .reset-btn { background: #fff; border: 2px solid #e74c3c; color: #e74c3c; flex: 1; max-width: 200px; }
        .reset-btn:hover { background: #e74c3c; color: white; transform: translateY(-2px); }

        .results-section { display: none; background: white; padding: 30px; border-radius: 10px; margin-top: 30px; border: 2px solid #f0f0f0; }
        .results-section.show { display: block; animation: slideUp 0.5s ease; }
        
        .result-title { font-size: 1.6em; color: #333; margin-bottom: 25px; text-align: center; font-weight: 700; }
        .subject-result { padding: 15px; margin-bottom: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border-left: 4px solid #ddd; }
        .subject-result.pass { background: #d4edda; border-left-color: #28a745; }
        .subject-result.fail { background: #f8d7da; border-left-color: #dc3545; }
        .subject-name { font-weight: 600; color: #333; font-size: 1.05em; }
        .subject-details { text-align: right; }
        .subject-details .marks { color: #555; font-weight: 600; }
        .subject-details .status { font-size: 0.9em; color: #666; margin-top: 5px; }
        .subject-result.pass .status { color: #28a745; font-weight: 600; }
        .subject-result.fail .status { color: #dc3545; font-weight: 600; }

        .summary-box { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 10px; margin: 25px 0; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; box-shadow: 0 10px 20px rgba(118, 75, 162, 0.2); }
        .summary-item { text-align: center; }
        .summary-label { font-size: 0.95em; opacity: 0.9; margin-bottom: 8px; }
        .summary-value { font-size: 2em; font-weight: 700; }

        .final-message { text-align: center; padding: 20px; background: #f0f0f0; border-radius: 8px; margin-top: 20px; font-size: 1.2em; font-weight: 700; color: #333; }
        .final-message.promote { background: #d4edda; color: #155724; border: 2px solid #28a745; }
        .final-message.fail { background: #f8d7da; color: #721c24; border: 2px solid #dc3545; }
        .final-message.supply { background: #fff3cd; color: #856404; border: 2px solid #ffc107; }

        .required-field { color: #dc3545; }

        .site-footer { width: 100%; background: rgba(0, 0, 0, 0.2); backdrop-filter: blur(10px); border-top: 1px solid rgba(255, 255, 255, 0.1); color: #fff; padding: 25px 0; text-align: center; margin-top: auto; }
        .footer-content { max-width: 900px; margin: 0 auto; display: flex; flex-direction: column; gap: 8px; }
        .creators { font-size: 1.1em; letter-spacing: 0.5px; }
        .creators span { font-weight: 700; color: #fff; text-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .copyright { font-size: 0.85em; color: rgba(255, 255, 255, 0.7); }

        /* --- RESPONSIVE DESIGN --- */
        @media (max-width: 768px) {
            .container { padding: 20px; margin-top: 10px; margin-bottom: 10px; }
            h1 { font-size: 1.8em; margin-top: 30px; /* Space for back button */ }
            .subtitle { font-size: 1em; }
            
            /* Stack buttons on mobile */
            .selection-container { flex-direction: column; width: 100%; }
            .stream-btn { width: 100%; padding: 15px; }
            
            /* Stack inputs on mobile */
            .input-row { grid-template-columns: 1fr; gap: 10px; }
            
            /* Stack summary box */
            .summary-box { grid-template-columns: 1fr; }
            
            /* Stack action buttons */
            .button-group { flex-direction: column; width: 100%; }
            .calculate-btn, .reset-btn { max-width: 100%; width: 100%; }
            
            /* Adjust Back Button */
            .back-btn { font-size: 1em; top: 15px; left: 15px; }
        }
    </style>
</head>
<body>
    
    <div class="main-content">
        <div class="container">
            <button id="back-btn" class="back-btn" onclick="goBack()">‚¨Ö Back</button>

            <h1>Marks Calculator</h1>
            <p class="subtitle">Session Ending Class 11 Result Prediction</p>

            <div id="active-stream-title" class="active-stream-title"></div>

            <div id="main-stream-selection" class="selection-container visible">
                <button class="stream-btn" onclick="selectMainStream('maths')">Maths Stream</button>
                <button class="stream-btn" onclick="selectMainStream('bio')">Biology Stream</button>
                <button class="stream-btn" onclick="selectMainStream('commerce')">Commerce Stream</button>
            </div>

            <div id="sub-stream-selection" class="selection-container">
                <button id="btn-sub-1" class="stream-btn" onclick="handleSubStreamClick('option1')">CS Stream</button>
                <button id="btn-sub-2" class="stream-btn" onclick="handleSubStreamClick('option2')">Hindi Stream</button>
            </div>

            <div id="cs-stream" class="subjects-container">
                <div class="subject-section"><h3 class="subject-title">üìö Physics <span class="subject-badge">Theory Max: 70</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="cs-phy-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 70)</span></label><input type="number" id="cs-phy-hy" max="70" placeholder="0-70"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="cs-phy-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 70)</span></label><input type="number" id="cs-phy-sse" max="70" placeholder="0-70"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 30)</span></label><input type="number" id="cs-phy-prac" max="30" placeholder="0-30"></div></div></div>
                <div class="subject-section"><h3 class="subject-title">‚öóÔ∏è Chemistry <span class="subject-badge">Theory Max: 70</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="cs-chem-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 70)</span></label><input type="number" id="cs-chem-hy" max="70" placeholder="0-70"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="cs-chem-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 70)</span></label><input type="number" id="cs-chem-sse" max="70" placeholder="0-70"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 30)</span></label><input type="number" id="cs-chem-prac" max="30" placeholder="0-30"></div></div></div>
                <div class="subject-section" id="cs-third-subject"><h3 class="subject-title" id="cs-third-title">üî¢ Maths</h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="cs-math-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint" id="cs-third-hy-hint">(Max 80)</span></label><input type="number" id="cs-math-hy" placeholder="0-80"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="cs-math-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint" id="cs-third-sse-hint">(Max 80)</span></label><input type="number" id="cs-math-sse" placeholder="0-80"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint" id="cs-third-prac-hint">(Max 20)</span></label><input type="number" id="cs-math-prac" placeholder="0-20"></div></div></div>
                <div class="subject-section"><h3 class="subject-title">üìñ English <span class="subject-badge">Theory Max: 80</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="cs-eng-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="cs-eng-hy" max="80" placeholder="0-80"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="cs-eng-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="cs-eng-sse" max="80" placeholder="0-80"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 20)</span></label><input type="number" id="cs-eng-prac" max="20" placeholder="0-20"></div></div></div>
                <div class="subject-section"><h3 class="subject-title">üíª Computer Science <span class="subject-badge">Theory Max: 70</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="cs-cs-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 70)</span></label><input type="number" id="cs-cs-hy" max="70" placeholder="0-70"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="cs-cs-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 70)</span></label><input type="number" id="cs-cs-sse" max="70" placeholder="0-70"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 30)</span></label><input type="number" id="cs-cs-prac" max="30" placeholder="0-30"></div></div></div>
            </div>

            <div id="hindi-stream" class="subjects-container">
                <div class="subject-section"><h3 class="subject-title">üìö Physics <span class="subject-badge">Theory Max: 70</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="hindi-phy-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 70)</span></label><input type="number" id="hindi-phy-hy" max="70" placeholder="0-70"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="hindi-phy-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 70)</span></label><input type="number" id="hindi-phy-sse" max="70" placeholder="0-70"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 30)</span></label><input type="number" id="hindi-phy-prac" max="30" placeholder="0-30"></div></div></div>
                <div class="subject-section"><h3 class="subject-title">‚öóÔ∏è Chemistry <span class="subject-badge">Theory Max: 70</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="hindi-chem-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 70)</span></label><input type="number" id="hindi-chem-hy" max="70" placeholder="0-70"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="hindi-chem-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 70)</span></label><input type="number" id="hindi-chem-sse" max="70" placeholder="0-70"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 30)</span></label><input type="number" id="hindi-chem-prac" max="30" placeholder="0-30"></div></div></div>
                <div class="subject-section" id="hindi-third-subject"><h3 class="subject-title" id="hindi-third-title">üî¢ Maths</h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="hindi-math-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint" id="hindi-third-hy-hint">(Max 80)</span></label><input type="number" id="hindi-math-hy" placeholder="0-80"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="hindi-math-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint" id="hindi-third-sse-hint">(Max 80)</span></label><input type="number" id="hindi-math-sse" placeholder="0-80"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint" id="hindi-third-prac-hint">(Max 20)</span></label><input type="number" id="hindi-math-prac" placeholder="0-20"></div></div></div>
                <div class="subject-section"><h3 class="subject-title">üìñ English <span class="subject-badge">Theory Max: 80</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="hindi-eng-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="hindi-eng-hy" max="80" placeholder="0-80"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="hindi-eng-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="hindi-eng-sse" max="80" placeholder="0-80"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 20)</span></label><input type="number" id="hindi-eng-prac" max="20" placeholder="0-20"></div></div></div>
                <div class="subject-section"><h3 class="subject-title">üáÆüá≥ Hindi <span class="subject-badge">Theory Max: 80</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="hindi-hindi-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="hindi-hindi-hy" max="80" placeholder="0-80"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="hindi-hindi-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="hindi-hindi-sse" max="80" placeholder="0-80"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 20)</span></label><input type="number" id="hindi-hindi-prac" max="20" placeholder="0-20"></div></div></div>
            </div>

            <div id="commerce-ip-stream" class="subjects-container">
                <div class="subject-section"><h3 class="subject-title">üìä Accountancy <span class="subject-badge">Theory Max: 80</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-ip-acc-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-ip-acc-hy" max="80" placeholder="0-80"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-ip-acc-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-ip-acc-sse" max="80" placeholder="0-80"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 20)</span></label><input type="number" id="comm-ip-acc-prac" max="20" placeholder="0-20"></div></div></div>
                <div class="subject-section"><h3 class="subject-title">üè¢ Business Studies <span class="subject-badge">Theory Max: 80</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-ip-bst-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-ip-bst-hy" max="80" placeholder="0-80"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-ip-bst-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-ip-bst-sse" max="80" placeholder="0-80"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 20)</span></label><input type="number" id="comm-ip-bst-prac" max="20" placeholder="0-20"></div></div></div>
                <div class="subject-section"><h3 class="subject-title">üìà Economics <span class="subject-badge">Theory Max: 80</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-ip-eco-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-ip-eco-hy" max="80" placeholder="0-80"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-ip-eco-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-ip-eco-sse" max="80" placeholder="0-80"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 20)</span></label><input type="number" id="comm-ip-eco-prac" max="20" placeholder="0-20"></div></div></div>
                <div class="subject-section"><h3 class="subject-title">üìñ English <span class="subject-badge">Theory Max: 80</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-ip-eng-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-ip-eng-hy" max="80" placeholder="0-80"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-ip-eng-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-ip-eng-sse" max="80" placeholder="0-80"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 20)</span></label><input type="number" id="comm-ip-eng-prac" max="20" placeholder="0-20"></div></div></div>
                <div class="subject-section"><h3 class="subject-title">üíª IP <span class="subject-badge">Theory Max: 70</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-ip-ip-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 70)</span></label><input type="number" id="comm-ip-ip-hy" max="70" placeholder="0-70"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-ip-ip-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 70)</span></label><input type="number" id="comm-ip-ip-sse" max="70" placeholder="0-70"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 30)</span></label><input type="number" id="comm-ip-ip-prac" max="30" placeholder="0-30"></div></div></div>
            </div>

            <div id="commerce-hindi-stream" class="subjects-container">
                <div class="subject-section"><h3 class="subject-title">üìä Accountancy <span class="subject-badge">Theory Max: 80</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-hindi-acc-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-hindi-acc-hy" max="80" placeholder="0-80"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-hindi-acc-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-hindi-acc-sse" max="80" placeholder="0-80"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 20)</span></label><input type="number" id="comm-hindi-acc-prac" max="20" placeholder="0-20"></div></div></div>
                <div class="subject-section"><h3 class="subject-title">üè¢ Business Studies <span class="subject-badge">Theory Max: 80</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-hindi-bst-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-hindi-bst-hy" max="80" placeholder="0-80"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-hindi-bst-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-hindi-bst-sse" max="80" placeholder="0-80"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 20)</span></label><input type="number" id="comm-hindi-bst-prac" max="20" placeholder="0-20"></div></div></div>
                <div class="subject-section"><h3 class="subject-title">üìà Economics <span class="subject-badge">Theory Max: 80</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-hindi-eco-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-hindi-eco-hy" max="80" placeholder="0-80"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-hindi-eco-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-hindi-eco-sse" max="80" placeholder="0-80"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 20)</span></label><input type="number" id="comm-hindi-eco-prac" max="20" placeholder="0-20"></div></div></div>
                <div class="subject-section"><h3 class="subject-title">üìñ English <span class="subject-badge">Theory Max: 80</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-hindi-eng-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-hindi-eng-hy" max="80" placeholder="0-80"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-hindi-eng-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-hindi-eng-sse" max="80" placeholder="0-80"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 20)</span></label><input type="number" id="comm-hindi-eng-prac" max="20" placeholder="0-20"></div></div></div>
                <div class="subject-section"><h3 class="subject-title">üáÆüá≥ Hindi <span class="subject-badge">Theory Max: 80</span></h3><div class="input-row"><div class="form-group"><label>PT1 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-hindi-hindi-pt1" max="40" placeholder="0-40"></div><div class="form-group"><label>Half Yearly Marks <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-hindi-hindi-hy" max="80" placeholder="0-80"></div></div><div class="input-row"><div class="form-group"><label>PT2 Marks <span class="required-field">*</span> <span class="input-hint">(Max 40)</span></label><input type="number" id="comm-hindi-hindi-pt2" max="40" placeholder="0-40"></div><div class="form-group"><label>SSE (Expected) <span class="required-field">*</span> <span class="input-hint">(Max 80)</span></label><input type="number" id="comm-hindi-hindi-sse" max="80" placeholder="0-80"></div></div><div class="input-row full"><div class="form-group"><label>Practical Marks <span class="required-field">*</span> <span class="input-hint">(Max 20)</span></label><input type="number" id="comm-hindi-hindi-prac" max="20" placeholder="0-20"></div></div></div>
            </div>

            <div id="calc-controls" class="button-group">
                <button class="calculate-btn" onclick="calculateMarks()">üìä Calculate Results</button>
                <button class="reset-btn" onclick="resetForm()">üîÑ Reset Form</button>
            </div>

            <div id="results" class="results-section">
                <div class="result-title">üìã Your Results</div>
                <div id="results-content"></div>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        <div class="footer-content">
            <p class="creators">Created by <span>Mudit Raj Gajpal</span> & <span>Tushti Gajpal</span></p>
            <p class="copyright">&copy; 2026 All Rights Reserved</p>
        </div>
    </footer>

    <script>
        // Global variables
        let currentMainStream = ''; 
        let currentSubStream = '';

        // --- STEP 1: Select Main Stream ---
        function selectMainStream(stream) {
            currentMainStream = stream;
            document.getElementById('main-stream-selection').classList.remove('visible');
            document.getElementById('back-btn').style.display = 'block'; // Show back button
            
            // Set Sub-Stream Button Text
            const btn1 = document.getElementById('btn-sub-1');
            const btn2 = document.getElementById('btn-sub-2');

            let mainLabel = '';
            if(stream === 'maths') mainLabel = "Science (Maths)";
            else if(stream === 'bio') mainLabel = "Science (Biology)";
            else mainLabel = "Commerce";

            document.getElementById('active-stream-title').setAttribute('data-main', mainLabel);

            if (stream === 'commerce') {
                btn1.innerText = "IP Stream";
                btn1.onclick = function() { handleSubStreamClick('ip'); };
                btn2.innerText = "Hindi Stream";
                btn2.onclick = function() { handleSubStreamClick('hindi'); };
            } else {
                // Science (Maths/Bio)
                btn1.innerText = "CS Stream";
                btn1.onclick = function() { handleSubStreamClick('cs'); };
                btn2.innerText = "Hindi Stream";
                btn2.onclick = function() { handleSubStreamClick('hindi'); };
            }

            document.getElementById('sub-stream-selection').classList.add('visible');
            if (stream !== 'commerce') updateThirdSubjectUI(stream);
        }

        // --- STEP 2: Handle Sub Stream Click ---
        function handleSubStreamClick(subStream) {
            currentSubStream = subStream;
            document.getElementById('sub-stream-selection').classList.remove('visible');
            
            let formId = '';
            let subLabel = '';

            if (currentMainStream === 'commerce') {
                if (subStream === 'ip') { formId = 'commerce-ip-stream'; subLabel = "IP Stream"; }
                if (subStream === 'hindi') { formId = 'commerce-hindi-stream'; subLabel = "Hindi Stream"; }
            } else {
                if (subStream === 'cs') { formId = 'cs-stream'; subLabel = "CS Stream"; }
                if (subStream === 'hindi') { formId = 'hindi-stream'; subLabel = "Hindi Stream"; }
            }

            const mainLabel = document.getElementById('active-stream-title').getAttribute('data-main');
            document.getElementById('active-stream-title').innerText = `${mainLabel} ‚Ä¢ ${subLabel}`;
            document.getElementById('active-stream-title').style.display = 'block';

            document.getElementById(formId).classList.add('active');
            document.getElementById('calc-controls').style.display = 'flex';
        }

        // --- BACK BUTTON LOGIC ---
        function goBack() {
            if (document.querySelector('.subjects-container.active')) {
                document.querySelectorAll('.subjects-container').forEach(el => el.classList.remove('active'));
                document.getElementById('calc-controls').style.display = 'none';
                document.getElementById('results').classList.remove('show');
                document.getElementById('active-stream-title').style.display = 'none';
                document.getElementById('sub-stream-selection').classList.add('visible');
            } 
            else if (document.getElementById('sub-stream-selection').classList.contains('visible')) {
                document.getElementById('sub-stream-selection').classList.remove('visible');
                document.getElementById('main-stream-selection').classList.add('visible');
                document.getElementById('back-btn').style.display = 'none';
            }
        }

        function updateThirdSubjectUI(type) {
            const isBio = (type === 'bio');
            const theoryMax = isBio ? 70 : 80;
            const pracMax = isBio ? 30 : 20;
            const title = isBio ? 'üß¨ Biology' : 'üî¢ Maths';
            const badge = `Theory Max: ${theoryMax}`;

            const forms = ['cs', 'hindi'];
            forms.forEach(prefix => {
                document.getElementById(`${prefix}-third-title`).innerHTML = `${title} <span class="subject-badge">${badge}</span>`;
                const hyInput = document.getElementById(`${prefix}-math-hy`);
                const sseInput = document.getElementById(`${prefix}-math-sse`);
                const pracInput = document.getElementById(`${prefix}-math-prac`);
                
                hyInput.setAttribute('max', theoryMax);
                hyInput.placeholder = `0-${theoryMax}`;
                document.getElementById(`${prefix}-third-hy-hint`).innerText = `(Max ${theoryMax})`;

                sseInput.setAttribute('max', theoryMax);
                sseInput.placeholder = `0-${theoryMax}`;
                document.getElementById(`${prefix}-third-sse-hint`).innerText = `(Max ${theoryMax})`;

                pracInput.setAttribute('max', pracMax);
                pracInput.placeholder = `0-${pracMax}`;
                document.getElementById(`${prefix}-third-prac-hint`).innerText = `(Max ${pracMax})`;
            });
        }

        // --- INPUT VALIDATION ---
        document.addEventListener('DOMContentLoaded', () => {
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    const max = parseInt(this.getAttribute('max'));
                    const min = parseInt(this.getAttribute('min')) || 0;
                    let value = parseInt(this.value);
                    if (isNaN(value)) return;
                    if (value > max) { this.value = max; flashError(this); }
                    if (value < min) { this.value = min; flashError(this); }
                });
            });
        });

        function flashError(element) {
            element.classList.add('input-error');
            setTimeout(() => element.classList.remove('input-error'), 300);
        }

        function getInputValue(id) {
            const el = document.getElementById(id);
            if(!el) return null;
            const value = el.value;
            if (value === '') return null;
            let num = parseFloat(value);
            const max = parseFloat(el.getAttribute('max'));
            if (num > max) return max; 
            return num;
        }

        function validateInputs() {
            let inputs = [];
            if (currentMainStream === 'commerce') {
                if (currentSubStream === 'ip') inputs = getCommerceIds('ip');
                else inputs = getCommerceIds('hindi');
            } else {
                inputs = getScienceIds(currentSubStream);
            }
            for (let id of inputs) {
                if (getInputValue(id) === null) {
                    alert('Please fill all fields for all subjects!');
                    return false;
                }
            }
            return true;
        }

        function getScienceIds(sub) {
            const prefix = (sub === 'cs') ? 'cs' : 'hindi';
            const suffixList = ['-pt1', '-hy', '-pt2', '-sse', '-prac'];
            const subjects = ['-phy', '-chem', '-math', '-eng', (sub === 'cs' ? '-cs' : '-hindi')];
            let ids = [];
            subjects.forEach(sub => {
                suffixList.forEach(suf => ids.push(prefix + sub + suf));
            });
            return ids;
        }

        function getCommerceIds(sub) {
            const prefix = (sub === 'ip') ? 'comm-ip' : 'comm-hindi';
            const suffixList = ['-pt1', '-hy', '-pt2', '-sse', '-prac'];
            const subjects = ['-acc', '-bst', '-eco', '-eng', (sub === 'ip' ? '-ip' : '-hindi')];
            let ids = [];
            subjects.forEach(sub => {
                suffixList.forEach(suf => ids.push(prefix + sub + suf));
            });
            return ids;
        }

        function calculateSubjectMarks(pt1, hy, pt2, sse, practical, hyMax, sseMax) {
            const b = (pt1 * 10) / 40;
            const c = (hy * 30) / hyMax;
            const d = (pt2 * 10) / 40;
            const e = (sse * 50) / sseMax;
            const f = b + c + d + e;
            const g = Math.floor((f * sseMax) / 100);
            const total = g + practical;
            const passMark = sseMax === 70 ? 23 : 26;
            return { theoryMarks: g, totalMarks: total, passingMarks: passMark };
        }

        function calculateMarks() {
            if (!validateInputs()) return;

            let results = [];
            let totalMarks = 0;
            let failCount = 0;
            let subjectData = [];

            if (currentMainStream === 'commerce') {
                const prefix = (currentSubStream === 'ip') ? 'comm-ip' : 'comm-hindi';
                const lastSub = (currentSubStream === 'ip') ? 'IP' : 'Hindi';
                subjectData = [
                    { name: 'Accountancy', id: prefix + '-acc', theoryMax: 80, pracMax: 20 },
                    { name: 'Business Studies', id: prefix + '-bst', theoryMax: 80, pracMax: 20 },
                    { name: 'Economics', id: prefix + '-eco', theoryMax: 80, pracMax: 20 },
                    { name: 'English', id: prefix + '-eng', theoryMax: 80, pracMax: 20 },
                    { name: lastSub, id: prefix + (currentSubStream === 'ip' ? '-ip' : '-hindi'), theoryMax: (currentSubStream === 'ip' ? 70 : 80), pracMax: (currentSubStream === 'ip' ? 30 : 20) }
                ];
            } else {
                const prefix = (currentSubStream === 'cs') ? 'cs' : 'hindi';
                const thirdName = (currentMainStream === 'bio') ? 'Biology' : 'Maths';
                const lastName = (currentSubStream === 'cs') ? 'Computer Science' : 'Hindi';
                let thirdTheory = 80, thirdPrac = 20;
                if(currentMainStream === 'bio') { thirdTheory = 70; thirdPrac = 30; }

                subjectData = [
                    { name: 'Physics', id: prefix + '-phy', theoryMax: 70, pracMax: 30 },
                    { name: 'Chemistry', id: prefix + '-chem', theoryMax: 70, pracMax: 30 },
                    { name: thirdName, id: prefix + '-math', theoryMax: thirdTheory, pracMax: thirdPrac },
                    { name: 'English', id: prefix + '-eng', theoryMax: 80, pracMax: 20 },
                    { name: lastName, id: prefix + (currentSubStream === 'cs' ? '-cs' : '-hindi'), theoryMax: (currentSubStream === 'cs' ? 70 : 80), pracMax: (currentSubStream === 'cs' ? 30 : 20) }
                ];
            }

            subjectData.forEach(sub => {
                const pt1 = getInputValue(sub.id + '-pt1');
                const hy = getInputValue(sub.id + '-hy');
                const pt2 = getInputValue(sub.id + '-pt2');
                const sse = getInputValue(sub.id + '-sse');
                const prac = getInputValue(sub.id + '-prac');

                const { theoryMarks, totalMarks: subjTotal, passingMarks } = calculateSubjectMarks(pt1, hy, pt2, sse, prac, sub.theoryMax, sub.theoryMax);
                const isPassing = theoryMarks >= passingMarks;
                totalMarks += subjTotal;
                if (!isPassing) failCount++;

                results.push({
                    subject: sub.name,
                    totalMarks: subjTotal,
                    theoryObtained: theoryMarks,
                    status: isPassing ? 'Pass' : 'Fail',
                    needMoreMarks: isPassing ? 0 : passingMarks - theoryMarks
                });
            });

            const percentage = (totalMarks / 500) * 100;
            const finalMessage = determineFinalMessage(failCount, results);
            displayResults(results, totalMarks, percentage, finalMessage);

            if (finalMessage.className === 'promote') triggerConfetti();
        }

        function triggerConfetti() {
            var duration = 3000;
            var end = Date.now() + duration;
            (function frame() {
                confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 }, colors: ['#667eea', '#764ba2', '#ffffff'] });
                confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 }, colors: ['#667eea', '#764ba2', '#ffffff'] });
                if (Date.now() < end) requestAnimationFrame(frame);
            }());
        }

        function determineFinalMessage(failCount, results) {
            if (failCount >= 2) return { message: '‚ùå You will FAIL in class 11', className: 'fail' };
            else if (failCount === 1) {
                const failedSubject = results.find(r => r.status === 'Fail').subject;
                return { message: `‚ö†Ô∏è Supply (Compartment) in ${failedSubject}`, className: 'supply' };
            } else return { message: '‚úÖ Promoted to Class 12', className: 'promote' };
        }

        function displayResults(results, totalMarks, percentage, finalMessage) {
            let html = '';
            results.forEach(result => {
                const resultClass = result.status === 'Pass' ? 'pass' : 'fail';
                const statusText = result.status === 'Pass' ? `‚úÖ ${result.status}` : `‚ùå ${result.status} (Need ${result.needMoreMarks} more in Theory)`;
                html += `<div class="subject-result ${resultClass}"><div class="subject-name">${result.subject}</div><div class="subject-details"><div class="marks">Total: ${result.totalMarks} / 100</div><div class="status" style="font-size:0.8em">Calc. Theory: ${result.theoryObtained}</div><div class="status">${statusText}</div></div></div>`;
            });
            html += `<div class="summary-box"><div class="summary-item"><div class="summary-label">Total Marks</div><div class="summary-value">${totalMarks} / 500</div></div><div class="summary-item"><div class="summary-label">Percentage</div><div class="summary-value">${percentage.toFixed(2)}%</div></div></div><div class="final-message ${finalMessage.className}">${finalMessage.message}</div>`;
            document.getElementById('results-content').innerHTML = html;
            document.getElementById('results').classList.add('show');
            setTimeout(() => { document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'nearest' }); }, 100);
        }

        function resetForm() {
            document.querySelectorAll('input[type="number"]').forEach(input => input.value = '');
            document.getElementById('results').classList.remove('show');
            document.getElementById('results-content').innerHTML = '';
            currentMainStream = ''; currentSubStream = '';
            document.querySelectorAll('.subjects-container').forEach(el => el.classList.remove('active'));
            document.getElementById('sub-stream-selection').classList.remove('visible');
            document.getElementById('calc-controls').style.display = 'none';
            document.getElementById('active-stream-title').style.display = 'none';
            document.getElementById('main-stream-selection').classList.add('visible');
            document.getElementById('back-btn').style.display = 'none';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        document.getElementById('main-stream-selection').classList.add('visible');
    </script>
</body>
</html>
